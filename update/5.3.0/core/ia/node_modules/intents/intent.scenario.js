'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _helpers = require('../ava-ia/helpers');

exports.default = function (state, actions) {

    if (state.isIntent) return (0, _helpers.resolve)(state);

    let match, flow, id;

    outerLoop:
    for (const key in Config.scenariosByRules) {
      const flowsArray = Config.scenariosByRules[key];
      for (let i = 0; i < flowsArray.length; i++) {
        match = (0, _helpers.syntax)(state.sentence, flowsArray[i].rules);
        if (match) {  
          flow = key;
          id = flowsArray[i].id;
          break outerLoop;
        }
      }
    }

    if (match) {
        state.flow = flow;
        state.id = id;
        state.isIntent = true;
        return (0, _helpers.factoryActions)(state, actions);
    } else
        return (0, _helpers.resolve)(state);

};