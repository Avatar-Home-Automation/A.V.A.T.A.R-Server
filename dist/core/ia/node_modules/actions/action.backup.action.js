'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

const extend = require('extend');

exports.default = function (state) {
	return new Promise( (resolve) =>  {
		const backupAction = Avatar.last(state.client);
		if (backupAction && backupAction.length > 0) {
			info(L.get(["ia.lastAction", state.client, backupAction[0].plugin]));
			setTimeout(() => {
				state.action = {
					module: backupAction[0].plugin,
					callback: backupAction[0].callback
				};
				extend(true, state, backupAction[0].options);
				resolve(state);
			}, Config.waitAction);
		} else {
			setTimeout(() => {
				state.action = {
					tts : true,
					value: L.get(["ia.noLastAction", state.client])
				};
				resolve(state);
			}, Config.waitAction);
		}
	})
}
